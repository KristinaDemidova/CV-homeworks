## HW2

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –¥–ª—è fine-tuning –º–æ–¥–µ–ª–∏ **DETR (DEtection TRansformer)** –Ω–∞ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ COCO (10 –∫–ª–∞—Å—Å–æ–≤).

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
*   `src/dataset.py`: –õ–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–ª–∞—Å—Å–æ–≤ –∏ `Collator` –¥–ª—è –ø–∞–¥–¥–∏–Ω–≥–∞ –±–∞—Ç—á–µ–π.
*   `src/train.py`: –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ TensorBoard, –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (PyTorch Profiler).
*   `src/analyze.py`: –°–∫—Ä–∏–ø—Ç –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –∏ –∞–Ω–∞–ª–∏–∑–∞ –æ—à–∏–±–æ–∫.
*   `download_coco.py`: –°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –Ω—É–∂–Ω–æ–≥–æ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö (—á–µ—Ä–µ–∑ `fiftyone`).
*   `requirements.txt`: –°–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

---

### –ó–∞–ø—É—Å–∫ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞

#### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
pip install fiftyone
```

#### 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ COCO 2017. –í—ã–±—Ä–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ 10 –∫–ª–∞—Å—Å–æ–≤:
`['person', 'car', 'bicycle', 'bus', 'truck', 'traffic light', 'stop sign', 'cat', 'dog', 'chair']`.

–ß—Ç–æ–±—ã —Å–∫–∞—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ (–∑–∞–π–º–µ—Ç ~2-3 –ì–ë):
```bash
python download_coco.py
```
–î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ø–∞–ø–∫—É `data/`.

#### 3. –û–±—É—á–µ–Ω–∏–µ
–ó–∞–ø—É—Å–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–≥–æ —Ü–∏–∫–ª–∞:
```bash
python train.py
```
*   –õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `runs/`.
*   –ß–µ–∫–ø–æ–∏–Ω—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `checkpoints/`.

#### 4. –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫
–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ:
```bash
python analyze.py
```
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–ø–∫—É `runs/` –≤ –≤–∏–¥–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π `analysis_N.png`.

---

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞

–î–ª—è –æ–±—É—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å `facebook/detr-resnet-50`. –ü–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π (classification head) –±—ã–ª –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ —Å–ª–æ–π —Å 10 –≤—ã—Ö–æ–¥–∞–º–∏ (+1 –¥–ª—è "no object").

**–ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
*   **Batch Size:** 4 (–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ VM)
*   **Learning Rate:** 1e-5 (Transformer)
*   **Epochs:** 10
*   **Optimizer:** AdamW
---

###  –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ Loss Analysis

–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è –ø—Ä–æ–≤–æ–¥–∏–ª—Å—è —á–µ—Ä–µ–∑ TensorBoard.
–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞: `tensorboard --logdir=runs`

#### –ì—Ä–∞—Ñ–∏–∫–∏ –ø–æ—Ç–µ—Ä—å (Loss Curves)
Loss ce

![loss_ce.png](./runs/loss_ce.png)

Loss bbox

![loss_bbox.png](./runs/loss_bbox.png)


**–ù–∞–±–ª—é–¥–µ–Ω–∏—è:**
1.  **Total Loss:** –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ–±—â–∏–π —Ç—Ä–µ–Ω–¥ –Ω–∞ —Å–Ω–∏–∂–µ–Ω–∏–µ.
2.  **Components:**
    *   `loss_ce` (Classification): –ü–∞–¥–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ –≤—Å–µ–≥–æ ‚Äî –º–æ–¥–µ–ª—å –±—ã—Å—Ç—Ä–æ —É—á–∏—Ç—Å—è –æ—Ç–ª–∏—á–∞—Ç—å —Å–æ–±–∞–∫—É –æ—Ç –º–∞—à–∏–Ω—ã.
    *   `loss_bbox` (Regression): –ü–∞–¥–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ, —Ç–∞–∫ –∫–∞–∫ —Ç–æ—á–Ω–∞—è –ø–æ–¥–≥–æ–Ω–∫–∞ –≥—Ä–∞–Ω–∏—Ü –æ–±—ä–µ–∫—Ç–∞ ‚Äî –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞.
---

### üîç Error Analysis (–ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫)

–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ(–∫—Ä–∞—Å–Ω–æ–µ - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–¥–µ–ª–∏, –∑–µ–ª–µ–Ω–æ–µ - –æ–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç):
![analysis_0.png](./runs/analysis_0.png)


![analysis_1.png](./runs/analysis_1.png)

**–û—à–∏–±–∫–∏:**
1.  **Localization Error:** –ú–æ–¥–µ–ª—å –≤–µ—Ä–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, `car`), –Ω–æ bounding box —Å–º–µ—â–µ–Ω –∏–ª–∏ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –æ–±—ä–µ–∫—Ç –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é (–Ω–∏–∑–∫–∏–π IoU).
![analysis_3.png](./runs/analysis_3.png)

![analysis_4.png](./runs/analysis_4.png)

2.  **Small Objects:** DETR –∏—Å–ø—ã—Ç—ã–≤–∞–µ—Ç —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏ —Å –¥–µ—Ç–µ–∫—Ü–∏–µ–π –º–µ–ª–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –∑–∞–¥–Ω–µ–º –ø–ª–∞–Ω–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–¥–∞–ª–µ–Ω–Ω—ã–µ `truck`).
![analysis_1.png](./runs/analysis_1.png)